; PlatformIO Project Configuration File
; Mosaic RAK Gateway - Waveshare ESP32-S3-ETH

[platformio]
default_envs = gateway
src_dir = src
include_dir = include
lib_dir = lib
data_dir = data

; ============================================================================
; COMMON SETTINGS
; ============================================================================
[env]
; ESP32 Arduino Core 3.x required for native W5500 support
platform = espressif32@^6.6.0
framework = arduino
monitor_speed = 115200

; ============================================================================
; GATEWAY ENVIRONMENT
; ============================================================================
[env:gateway]
board = esp32-s3-devkitc-1
upload_speed = 115200
board_build.partitions = default_8MB.csv
board_build.filesystem = littlefs

; USB CDC settings
build_flags =
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DARDUINO_USB_MODE=1
    -DCORE_DEBUG_LEVEL=3
    ; Project defines
    -DGATEWAY_VERSION=\"1.0.0\"
    -DDEVICE_NAME=\"Mintyfi_LoRa_Gateway\"
    ; W5500 Ethernet SPI config (required for ETHClass2)
    -DCONFIG_ETH_SPI_ETHERNET_W5500=1
    ; W5500 Ethernet Pins (Waveshare ESP32-S3-ETH)
    -DW5500_MOSI=11
    -DW5500_MISO=12
    -DW5500_CLK=13
    -DW5500_CS=14
    -DW5500_INT=10
    -DW5500_RST=9
    ; LED & Button
    -DNEOPIXEL_PIN=21
    -DBUTTON_PIN=0
    ; LoRa UART Pins
    -DLORA_UART_TX=17
    -DLORA_UART_RX=18
    ; Network config in config.h

; Library dependencies (ETH.h is built-in to ESP32 Arduino core)
lib_deps =
    knolleary/PubSubClient@^2.8
    bblanchon/ArduinoJson@^7.0.2
    adafruit/Adafruit NeoPixel@^1.12.0

; Monitor settings
monitor_filters =
    esp32_exception_decoder
    colorize
